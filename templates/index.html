<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriByte</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>

    <!-- Navigation Buttons -->
    <div class="nav-buttons">
        <button onclick="toggleSidebar()">☰</button>
        <button onclick="location.href='/chatbot'">Chatbot</button>
        <button onclick="location.href='/team'">Team Page</button>
    </div>

    <!--Sidebar for social media aspect-->
    <div id="sidebar" class="sidebar">

        <!-- Close button at the top-->
         <div class="sidebar-header">
            <button class="close-btn" onclick="closeSidebar()">✖</button>
         </div>
        
         <div class="sidebar-content">
            <h2>Friends</h2>
            <ul id="friend-list"></ul>

            <!-- Add Friend Input & Button-->
            <div class="add-friend-section">
                <input type="text" id="new-friend-name" placeholder="Enter friend's name" />
                <button onclick="addFriend()">Add Friend</button>
            </div> 

            <h2>Recent Posts</h2>
            <div id="post-list">
                
            </div>
         </div>

        <!-- Bottom Buttons-->
         <div class="sidebar-footer">
            <button class="create-post-btn" onclick="openCreatePostModal()"> + Create Post</button>
            <button class="expand-sidebar-btn" onclick="expandSidebar()">Expand</button>
         </div>
    </div>

    <h1>Welcome to NutriByte</h1>

    <!-- Meal Plan Generator and Recipe Search -->
    <div class="meal-plan-section">
        <button onclick="generateMealPlan()">Generate Meal Plan</button>
        <div class="recipe-search">
            <input type="text" id="recipe-query" placeholder="Search for recipes...">
            <button onclick="searchRecipes()">Search</button>
        </div>
    </div>

    <section class="mission">
        <h2>Our Mission</h2>
        <p>
            At <strong>NutriByte</strong>, we aim to revolutionize meal planning and nutrition tracking by providing 
            personalized, AI-driven solutions. Many people struggle with unhealthy eating habits due to 
            one-size-fits-all meal plans, time-consuming manual tracking, and the high cost of healthy foods. 
            Our platform offers smart meal planning, budget-friendly grocery integration, and AI-powered 
            nutrient tracking, making it easier for users to make informed, healthier food choices effortlessly.
        </p>
    </section>
    
    <button onclick="fetchMessage()">Get Message</button>
    <p id="message"></p>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

    <!-- Create Post Modal -->
     <div id="createPostModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeCreatePostModal()">&times;</span>
            <h2>Create a Post</h2>
            <form id="createPostForm" enctype="multipart/form-data">
                <textarea id="post-text" placeholder="What's on your mind?" rows="4" required></textarea>
                <input type="file" id="post-image" accept="image/*">
                <button type="submit">Post</button> 
            </form>
        </div>
     </div>

     <script>
        async function loadSidebarContent(username) {
            const friendList = document.getElementById('friend-list');
            const postList = document.getElementById('post-list');
        
            friendList.innerHTML = '<li>Loading...</li>';
            postList.innerHTML = '<p>Loading posts...</p>';
        
            try {
                const [friendsRes, postsRes] = await Promise.all([
                    fetch(`/api/friends/${username}`),
                    fetch(`/api/posts/${username}`)
                ]);
        
                const friends = await friendsRes.json();
                const posts = await postsRes.json();
        
                // Friends
                friendList.innerHTML = '';
                if (friends.length === 0) {
                    friendList.innerHTML = '<li>No friends yet.</li>';
                } else {
                    friends.forEach(friend => {
                        const li = document.createElement('li');
                        li.textContent = friend.username;
                        friendList.appendChild(li);
                    });
                }
        
                // Posts
                postList.innerHTML = '';
                if (posts.length === 0) {
                    postList.innerHTML = '<p>No recent posts.</p>';
                } else {
                    posts.forEach(post => {
                        const p = document.createElement('p');
                        p.innerHTML = `<strong>${post.author}:</strong> ${post.text}`;
                        postList.appendChild(p);
                    });
                }
            } catch (err) {
                friendList.innerHTML = '<li>Error loading friends</li>';
                postList.innerHTML = '<p>Error loading posts</p>';
                console.error(err);
            }
        }
        </script>

<script src="/static/script.js" defer></script>

        

</body>
</html>
